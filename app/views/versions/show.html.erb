<div class="container-sm">
  <h2><%= link_to @registry.name, registry_packages_path(@registry.name) %> : <%= link_to @package.name, registry_package_path(@registry.name, @package.name) %> : <%= @version.number %></h2>

  <p>
    <%= @package.description %>
  </p>

  <p>
    <% if @version.registry_url.present? %>
      <%= link_to 'Registry', @version.registry_url, target: :_blank %> - 
    <% end %>
    <% if @version.documentation_url.present? %>
      <%= link_to 'Documentation', @version.documentation_url, target: :_blank %> - 
    <% end %>
    <% if @version.download_url.present? %>
      <%= link_to 'Download', @version.download_url, target: :_blank %> -
    <% end %>
    <% if @version.integrity.present? %>
      <br>Integrity: <%= @version.integrity %> -
    <% end %>
    Published: <%= time_ago_in_words @version.published_at %> ago - Indexed: <%= time_ago_in_words @version.created_at %> ago 
  </p>

  <% if @version.download_url.present? && @package.versions_count > 1 %>
    <div class="dropdown mb-3">
      <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
        Diff between versions
      </a>

      <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <% @package.versions.sort.each do |version| %>
          <% next if version == @version %>
          <% next if version.download_url.blank? %>
          <li>
            <%= link_to version, @version.diff_url(version), class: 'dropdown-item', target: :_blank %>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% if @version.download_url.present? %>
    <div class='card' id="files" data-url="<%= @version.download_url %>" data-basename="<%= @version.archive_basename %>" data-path="<%= params[:path] %>">
      <div id='files-header' class="card-header"></div>
      <ul id="files-list" class="list-group list-group-flush"></ul>
      <div id="files-content" class="card-body">Loading...</div>
    </div>
  <% end %>
</div>
