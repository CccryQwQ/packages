<% @meta_description = @package.description_with_fallback %>
<% @meta_title = "#{@package.name} | #{@registry.name}" %>

<div class="container-sm">

  <%= render 'details' %>

  <ul class="nav nav-tabs my-3">
    <li class="nav-item">
      <a class="nav-link active" aria-current="page">
        Versions
        <span class="badge bg-secondary rounded-pill">
          <%= number_with_delimiter @package.versions_count %>
        </span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="<%= dependent_packages_registry_package_path(@registry, @package) %>">
        Dependent Packages
        <span class="badge bg-secondary rounded-pill">
          <%= number_with_delimiter @package.dependent_packages_count %>
        </span>
      </a>
    </li>
    <% maintainers_count = @package.maintainers.count %>
    <% if maintainers_count > 0 %>
      <li class="nav-item">
        <a class="nav-link" href="<%= maintainers_registry_package_path(@registry, @package) %>">
          Maintainers
          <span class="badge bg-secondary rounded-pill">
            <%= number_with_delimiter maintainers_count %>
          </span>
        </a>
      </li>
    <% end %>
    <% related_packages_count = @package.related_packages.count %>
    <% if related_packages_count > 0 %>
      <li class="nav-item">
        <a class="nav-link" href="<%= related_packages_registry_package_path(@registry, @package) %>">
          Related Packages
          <span class="badge bg-secondary rounded-pill">
            <%= number_with_delimiter related_packages_count %>
          </span>
        </a>
      </li>
    <% end %>
  </ul>

  <% if @versions.any? %>
    <%= render @versions %>
    <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>  
  <% elsif @package.download_url.present? %>
    <div class='card' id="files" data-url="<%= @package.download_url %>" data-basename="<%= @package.archive_basename %>" data-path="<%= params[:path] %>">
      <div id='files-header' class="card-header"></div>
      <ul id="files-list" class="list-group list-group-flush"></ul>
      <div id="files-content" class="card-body">Loading...</div>
    </div>
  <% end %>
</div>